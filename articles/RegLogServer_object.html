<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="shiny.reglog">
<title>RegLogServer object fields and methods • shiny.reglog</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RegLogServer object fields and methods">
<meta property="og:description" content="shiny.reglog">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">shiny.reglog</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/RegLogServer_object.html">RegLogServer object and its fields and methods</a>
    <a class="dropdown-item" href="../articles/create_custom_handlers.html">Creating custom RegLogConnector handlers</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="RegLogServer_object_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>RegLogServer object fields and methods</h1>
            
      
      
      <div class="d-none name"><code>RegLogServer_object.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about-r6-and-specifically-reglogserver-class">About R6 and specifically RegLogServer Class<a class="anchor" aria-label="anchor" href="#about-r6-and-specifically-reglogserver-class"></a>
</h2>
<p><em>R6</em> is the alternative class system available for <strong>R</strong> users. It is more driven towards Object Oriented Programming vs Functional Programming that is most known to <strong>R</strong> users via built-in <em>S3</em> class system.</p>
<p><em>R6</em> is ideal for creating more complex systems - it keeps all their elements enclosed in their own environment. Most of <strong>R</strong> users actually uses <em>R6</em> objects on daily basis: eg. the whole <em>Shiny</em> system is built as system of <em>R6</em> objects.</p>
<p>Basically, all there is to know about <em>R6</em> system in regards to <em>shiny.reglog</em> usage is, that:</p>
<ul>
<li>all modules available in <em>shiny.reglog</em> are <em>R6</em> classes:
<ul>
<li><em>RegLogServer</em></li>
<li>dbConnectors - which are used by every <em>RegLogServer</em> to communicate with database containing your user data.
<ul>
<li><em>RegLogDBIConnector</em></li>
<li><em>RegLogGsheetConnector</em></li>
</ul>
</li>
<li>mailConnectors - which are used by every <em>RegLogServer</em> to send emails to users of your ShinyApp.
<ul>
<li><em>RegLogEmayiliConnector</em></li>
<li><em>RegLogGmailConnector</em></li>
</ul>
</li>
<li>vanilla <em>RegLogConnector</em>, that you can use to create your own <em>Connector</em> class with inheritance.</li>
</ul>
</li>
<li>R6 objects after initialization have public elements, that can be accessed with <code>$</code>. They can be either <em>fields</em>, holding some values, or <em>methods</em> containing functions.</li>
</ul>
<p>If you want to get to know more about R6 system as a whole I advise you to check out <a href="https://r6.r-lib.org/articles/" class="external-link">articles created by R6 maintainers</a>. Below I will talk more thoroughly about <em>RegLogServer</em> class and its public fields and methods.</p>
<p>There are multiple public elements to <em>RegLogServer</em>. To keep them in order, I will describe them on basis of their usage. In all code chunks I will refer to them as if they would be called from an object assigned as <em>RegLogServer</em>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">RegLogServer</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RegLogServer.html">RegLogServer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    dbConnector <span class="op">=</span> <span class="va">dbConnector</span>,</span>
<span>    mailConnector <span class="op">=</span> <span class="va">mailConnector</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="state-of-user-in-current-shinyapp-session">State of user in current ShinyApp session<a class="anchor" aria-label="anchor" href="#state-of-user-in-current-shinyapp-session"></a>
</h2>
<p>Elements described there are the most important things that every creator of ShinyApp that incorporates <em>shiny.reglog</em> should be using to profit from user login. All of them are <code>reactiveVal</code> objects, so you can <code>observe</code> their changes and to access their current value you need to include them with parentheses.</p>
<div class="section level3">
<h3 id="check-if-the-user-in-current-session-is-logged-in">Check if the user in current session is logged in<a class="anchor" aria-label="anchor" href="#check-if-the-user-in-current-session-is-logged-in"></a>
</h3>
<p><code>is_logged</code> is a simple boolean value to check if the user in current session is logged in (<code>TRUE</code>) or not (<code>FALSE</code>)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># observe the reactiveVal change</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">RegLogServer</span><span class="op">$</span><span class="va">is_logged</span>, <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># if contains TRUE: user is currently logged-in</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">RegLogServer</span><span class="op">$</span><span class="fu">is_logged</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showModal.html" class="external-link">showModal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/modalDialog.html" class="external-link">modalDialog</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"You are logged in!"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co"># if contains FALSE: user isn't logged-in</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showModal.html" class="external-link">showModal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/modalDialog.html" class="external-link">modalDialog</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"You are not logged in!"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="current-id-of-the-user">Current ID of the user<a class="anchor" aria-label="anchor" href="#current-id-of-the-user"></a>
</h3>
<p><code>user_id</code> field (character string): unique user ID. When the user isn’t logged it contains generated at the start of the session (or after logout) <em>Universally Unique Identifier</em> (with the use of <code><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">uuid::UUIDgenerate()</a></code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">uuid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">UUIDgenerate</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "169215e6-89e5-40f9-a731-666f11f9ebc4"</span></span></code></pre></div>
<p>After login it contains the username that the user have chosen during registration procedure.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RegLogServer</span><span class="op">$</span><span class="fu">user_id</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="email-address-of-the-currently-logged-user">Email address of the currently logged user<a class="anchor" aria-label="anchor" href="#email-address-of-the-currently-logged-user"></a>
</h3>
<p><code>user_mail</code> field (character string): unique user email. When the user is logged in, it contains the email that is currently associated with their <em>user_id</em>. Otherwise, it contains empty character string (<code>""</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RegLogServer</span><span class="op">$</span><span class="fu">user_mail</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="account-id-of-the-logged-user">Account ID of the logged user<a class="anchor" aria-label="anchor" href="#account-id-of-the-logged-user"></a>
</h3>
<p><code>account_id</code> field (character string): unique account ID. It provides the simple way to relate to the specific logged users in other, custom tables in the database (eg.: settings saved for specific users).</p>
<ul>
<li>value of the <strong>id</strong> column in the <em>account</em> table for <strong>SQL databases</strong>
</li>
<li>
<strong>row number - 1</strong> (header) in the <em>account</em> spreadsheet for <strong>googlesheet database</strong>.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RegLogServer</span><span class="op">$</span><span class="fu">account_id</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="user-logout">User logout<a class="anchor" aria-label="anchor" href="#user-logout"></a>
</h2>
<p>You can insert an event to logout user by calling public method.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if you create an actionButton "logout_button" in your UI, you can observe</span></span>
<span><span class="co"># its action and logout after press:</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">logout_button</span>, <span class="op">{</span></span>
<span>  <span class="va">RegLogServer</span><span class="op">$</span><span class="fu">logout</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ui-object-lists">UI object lists<a class="anchor" aria-label="anchor" href="#ui-object-lists"></a>
</h2>
<p>There are dedicated functions for creating UI for different functionalities of the <em>RegLog</em> system: <code>RegLog_login_UI</code>, <code>RegLog_register_UI</code>, <code>RegLog_credsEdit_UI</code> and <code>RegLog_resetPass_UI</code>. They put whole default <code>tagLists</code> into the UI, though.</p>
<p>It is expected that there will be users who would want more freedom with how their UI should look like. That’s why there are dedicated public fields containing named lists of UI elements for all of these functionalities. You can use these to create your own, custom <code>renderUI</code> output.</p>
<ul>
<li>
<code>UI_list_login</code> containing elements of login procedure tags</li>
<li>
<code>UI_list_register</code> containing elements of register procedure tags</li>
<li>
<code>UI_list_credsEdit</code> containing elements of credentials edit procedure tags</li>
<li>
<code>UI_list_resetPass</code> containing elements of reset password procedure tags</li>
</ul>
</div>
<div class="section level2">
<h2 id="message">Message<a class="anchor" aria-label="anchor" href="#message"></a>
</h2>
<p><code>message</code> field is another <code>reactiveVal</code> value that can be used to observe <strong>any</strong> change of the <em>RegLogServer</em> object state. It always contains most recent object of <em>S3</em> class <strong>RegLogConnectorMessage</strong>, that the <em>RegLogServer</em> received from its <em>dbConnector</em> or was specifically generated to communicate specific status changes.</p>
<blockquote>
<p>Messages received from mailConnector aren’t exposed in this field. Instead, they are exposed in <code>RegLogServer$mail_message()</code> field. They are separated because they don’t idicate a change in state of <em>RegLog system</em> itself - instead, they just show the feedback from mail sending service.</p>
</blockquote>
<p>Creation of custom logic depending on its change isn’t at all necessary. It can be handy especially when for any reason you want to inhibit the default <em>modalDialog</em>s that are called by <em>RegLogServer</em> to inform end-user about consequences of their actions (eg. successful login or unsuccessful, because the inputed user ID or password is incorrect).</p>
<p>Every <em>RegLogConnectorMessage</em> is specific type of <em>list</em> and can contain up to four elements:</p>
<ul>
<li>
<strong>time</strong>: numeric representation of <code><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time()</a></code> when it was generated</li>
<li>
<strong>type</strong>: indicates the type of the process during which the message was generated</li>
<li>
<strong>data</strong>: <em>list</em> containing data that was send with this message. Values contained there can be specific to certain <em>type</em> of the message</li>
<li>
<strong>logcontent</strong>: all <em>RegLogConnectorMessage</em>s send by and received by the <em>RegLogServer</em> object (and by every <em>RegLogConnector</em>) are appended to that object <code>log</code> field. Content there will be saved as a <em>note</em> in the logs.</li>
</ul>
<p>Below I want to characterize all types of <em>RegLogConnectorMessages</em> that can be exposed in the <code>RegLogServer$message()</code> field. Besides them there are also messages that are send by the <em>RegLogServer</em> to its <em>Connectors</em>. To learn more about these, read vignette <strong>Creating custom RegLogConnector handlers</strong>.</p>
<blockquote>
<p>Conditions for every default modalDialog are written in the order they should be checked in for best results. Conditions written like <code>value == FALSE</code> can be checked like that - the <em>message</em> of given type always contains this object. Conditions written like <code>isFALSE(value)</code> means that the specified <em>value</em> in the <em>message</em> can be <code>NULL</code>.</p>
</blockquote>
<div class="section level3">
<h3 id="type-ping">Type: <strong>ping</strong><a class="anchor" aria-label="anchor" href="#type-ping"></a>
</h3>
<p>Type of the message that is produced by all classes inheriting from <em>RegLogConnector</em> upon their initialization, making it also the very first available in <code>RegLogServer$message()</code> field. Received message of this type contains:</p>
<ul>
<li>
<em>data</em>: response_time: time between receiving the <strong>ping</strong> message and sending this message back</li>
<li>
<em>logcontent</em>: for message upon initialization it will hold value “init”.</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-login_front">Type: <strong>login_front</strong><a class="anchor" aria-label="anchor" href="#type-login_front"></a>
</h3>
<p>Type of the message generated by <em>RegLogServer</em> object itself. Contains information about invalidity of values provided during login procedure by user. It contains:</p>
<ul>
<li>
<strong>data</strong>
<ul>
<li>success: boolean - <code>FALSE</code>
</li>
<li>input_provided: boolean - <code>FALSE</code>
</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialogs</em>:</p>
<ul>
<li>login_noInput (<code>input_provided == FALSE</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-login">Type: <strong>login</strong><a class="anchor" aria-label="anchor" href="#type-login"></a>
</h3>
<p>Type of the message received from the database connectors with responses about login procedure. It contains:</p>
<ul>
<li>
<strong>data</strong>:
<ul>
<li>success: boolean - <code>TRUE</code> if the login was successful</li>
<li>username: boolean - <code>TRUE</code> if the username exists in the database</li>
<li>password: boolean - <code>TRUE</code> if the password provided match</li>
<li>
<em>user_id</em>: character - contains user_id presented afterwards in the <code>RegLogServer$user_id()</code>. Only if <code>success == TRUE</code>
</li>
<li>
<em>user_mail</em>: character - contains user_mail presented afterwards in the <code>RegLogServer$user_mail()</code>. Only if <code>success == TRUE</code>
</li>
</ul>
</li>
<li>
<strong>logcontent</strong>:
<ul>
<li>brief information with username provided by the user and if the login was successful.</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialogs</em>:</p>
<ul>
<li>login_badId (<code>data$success == FALSE &amp;&amp; data$username == FALSE</code>)</li>
<li>login_badPass (<code>data$success == FALSE &amp;&amp; data$password == FALSE</code>)</li>
<li>login_success (<code>data$success == TRUE</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-register_front">Type: <strong>register_front</strong><a class="anchor" aria-label="anchor" href="#type-register_front"></a>
</h3>
<p>Type of the message generated by <em>RegLogServer</em> object itself. Contains information about invalidity of values provided during register procedure by user. It contains:</p>
<ul>
<li>
<strong>data</strong>:
<ul>
<li>success: boolean - <code>FALSE</code>
</li>
<li>input_provided: boolean - <code>TRUE</code> if all needed inputs were provided</li>
<li>valid_id: boolean - <code>TRUE</code> if provided user ID was valid</li>
<li>valid_email: boolean - <code>TRUE</code> if provided email was valid</li>
<li>valid_pass: boolean - <code>TRUE</code> if provided password was valid</li>
<li>identical_pass: boolean - <code>FALSE</code> (it is the last condition checked)</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialogs</em>:</p>
<ul>
<li>register_noInput (<code>data$input_provided == FALSE</code>)</li>
<li>register_nonValidId (<code>isFALSE(data$valid_id)</code>)</li>
<li>register_nonValidEmail (<code>isFALSE(data$valid_email)</code>)</li>
<li>register_nonValidPass (<code>isFALSE(data$valid_pass)</code>)</li>
<li>register_notIndenticalPass (<code>isFALSE(data$identical_pass)</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-register">Type: <strong>register</strong><a class="anchor" aria-label="anchor" href="#type-register"></a>
</h3>
<p>Type of the message received from the database connector with responses about register procedure. It contains:</p>
<ul>
<li>
<strong>data</strong>:
<ul>
<li>success: boolean - <code>TRUE</code> if the register was successful</li>
<li>username: boolean - <code>TRUE</code> if there were no conflicts with existing usernames in the database</li>
<li>email: boolean - <code>TRUE</code> if there were no conflicts with existing e-mails in the database</li>
<li>
<em>user_id</em>: character - contains user ID with which new user have been registered. Only if <code>success == TRUE</code>
</li>
<li>
<em>user_mail</em>: character - contains e-mail with which new user have been registered. Only if <code>success == TRUE</code>
</li>
</ul>
</li>
<li>
<strong>logcontent</strong>:
<ul>
<li>registered user ID and mail if the register was successful or value of the element which caused conflict.</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialogs</em>:</p>
<ul>
<li>register_existingId (<code>data$success == FALSE &amp;&amp; data$username == FALSE</code>)</li>
<li>register_existingEmail (<code>data$success == FALSE &amp;&amp; data$email == FALSE</code>)</li>
<li>register_success (<code>data$success == TRUE</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-credsedit_front">Type: <strong>credsEdit_front</strong><a class="anchor" aria-label="anchor" href="#type-credsedit_front"></a>
</h3>
<p>Type of the message generated by <em>RegLogServer</em> object itself. Contains information about invalidity of values provided during credentials change procedure by user. It contains:</p>
<ul>
<li>
<strong>data</strong>:
<ul>
<li>success: boolean - <code>FALSE</code> (generated only when something is invalid)</li>
<li>user_logged: boolean - <code>TRUE</code> if user is currently logged in</li>
<li>input_provided: boolean - <code>TRUE</code> if required inputs are not empty</li>
<li>valid_id: boolean - <code>TRUE</code> if provided user ID was valid</li>
<li>valid_email: boolean - <code>TRUE</code> if provided email was valid</li>
<li>valid_pass: boolean - <code>TRUE</code> if provided password was valid</li>
<li>identical_pass: boolean - <code>FALSE</code> (it is the last condition checked)</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialogs</em>:</p>
<ul>
<li>credsEdit_notLogged (<code>data$user_logged == FALSE</code>)</li>
<li>credsEdit_noInput_pass (<code>isFALSE(data$input_provided) &amp;&amp; change == "pass"</code>)</li>
<li>credsEdit_noInput_other (<code>isFALSE(data$input_provided) &amp;&amp; change == "other"</code>)</li>
<li>credsEdit_nonValidId (<code>isFALSE(data$valid_id)</code>)</li>
<li>credsEdit_nonValidEmail (<code>isFALSE(data$valid_email)</code>)</li>
<li>credsEdit_nonValidPass (<code>isFALSE(data$valid_pass)</code>)</li>
<li>credsEdit_notIdenticalPass (<code>isFALSE(data$identical_pass)</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-credsedit">Type: <strong>credsEdit</strong><a class="anchor" aria-label="anchor" href="#type-credsedit"></a>
</h3>
<p>Type of the message received from the database connector with responses about credentials edit procedure. It contains:</p>
<ul>
<li>
<strong>data</strong>:
<ul>
<li>success: boolean - <code>TRUE</code> if credentials edit was successful</li>
<li>username: boolean - <code>TRUE</code> if provided username was found</li>
<li>password: boolean - <code>TRUE</code> if provided password was correct</li>
<li>
<em>new_username</em>: boolean - <code>TRUE</code> if provided new ID weren’t in database (no conflicts). Only if there were some conflict.</li>
<li>
<em>new_mail</em>: boolean - <code>TRUE</code> if provided new e-mail weren’t in database (no conflicts). Only if there were some conflict.</li>
<li>
<em>new_user_id</em>: character - contains new user ID. Only if user ID was changed.</li>
<li>
<em>new_user_mail</em>: character - contains new user e-mail. Only if user mail was changed.</li>
<li>
<em>new_user_pass</em>: boolean - <code>TRUE</code>. Only if user password was changed.</li>
</ul>
</li>
<li>
<strong>logcontent</strong>:
<ul>
<li>brief information about changes.</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialogs</em>:</p>
<ul>
<li>credsEdit_badId (<code>data$success == FALSE &amp;&amp; data$username == FALSE</code>)</li>
<li>credsEdit_badPass (<code>data$success == FALSE &amp;&amp; data$password == FALSE</code>)</li>
<li>credsEdit_existingId (<code>data$success == FALSE &amp;&amp; isFALSE(data$username)</code>)</li>
<li>credsEdit_existingEmail (<code>data$success == FALSE &amp;&amp; isFALSE(data$email)</code>)</li>
<li>credsEdit_success (<code>data$success == TRUE</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-resetpass_front">Type: <strong>resetPass_front</strong><a class="anchor" aria-label="anchor" href="#type-resetpass_front"></a>
</h3>
<p>Type of the message generated by <em>RegLogServer</em> object itself. Contains information about invalidity of values provided during password reset procedure by user. It contains:</p>
<ul>
<li>
<strong>data</strong>
<ul>
<li>success: boolean - <code>FALSE</code> (message generated only when something is invalid)</li>
<li>step: character - either <code>generate</code> or <code>confirm</code>, depending on the step of the process</li>
<li>input_provided: boolean - <code>TRUE</code> if the inputs required for specific step were provided</li>
<li>valid_pass: boolean - <code>TRUE</code> if provided password was valid</li>
<li>identical_pass: boolean - <code>FALSE</code> (it is the last condition checked)</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialogs</em>:</p>
<ul>
<li>resetPass_noInput_generate (<code>data$step == "generate" &amp;&amp; isFALSE(data$input_provided)</code>)</li>
<li>resetPass_noInput_confirm (<code>data$step == "confirm" &amp;&amp; isFALSE(data$input_provided)</code>)</li>
<li>resetPass_nonValidPass (<code>isFALSE(data$valid_pass)</code>)</li>
<li>resetPass_notIdenticalPass (<code>isFALSE(data$identical_pass)</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-resetpass_generate">Type: <strong>resetPass_generate</strong><a class="anchor" aria-label="anchor" href="#type-resetpass_generate"></a>
</h3>
<p>Type of the message received from the database connector with responses about password reset procedure - code generation step. It contains:</p>
<ul>
<li>
<strong>data</strong>:
<ul>
<li>success: boolean - <code>TRUE</code> if reset code was created successfully</li>
<li>username: boolean - <code>TRUE</code> if the username was found in the database</li>
<li>email: character - email to which the reset code will be sent</li>
</ul>
</li>
<li>
<strong>logcontent</strong>:
<ul>
<li>information about user for whom the reset code was generated and to which email it will be sent.</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialog</em>:</p>
<ul>
<li>resetPass_badId (<code>data$username == FALSE</code>)</li>
<li>resetPass_codeGenerated (<code>data$success == TRUE</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-resetpass_confirm">Type: <strong>resetPass_confirm</strong><a class="anchor" aria-label="anchor" href="#type-resetpass_confirm"></a>
</h3>
<p>Type of the message received from the database connector with responses about password reset procedure - code confirmation step. It contains:</p>
<ul>
<li>
<strong>data</strong>
<ul>
<li>success: boolean - <code>TRUE</code> if the password was changed successfully</li>
<li>username: boolean - <code>TRUE</code> if the username was found in the database</li>
<li>code_valid: boolean - <code>TRUE</code> if the reset code was valid (both matched and not expired)</li>
</ul>
</li>
<li>
<strong>logcontent</strong>
<ul>
<li>username for which the password was changed.</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialogs</em>:</p>
<ul>
<li>resetPass_badId (<code>data$username == FALSE</code>)</li>
<li>resetPass_nonValidCode (<code>isFALSE(data$code_valid)</code>)</li>
<li>resetPass_success (<code>data$success == TRUE</code>)</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-logout">Type: <strong>logout</strong><a class="anchor" aria-label="anchor" href="#type-logout"></a>
</h3>
<p>Type of the message generated by <em>RegLogServer</em> itself, indicating that the user have been logged out. It contains:</p>
<ul>
<li>
<strong>data</strong>
<ul>
<li>success: boolean - <code>TRUE</code> if the user was logged in and have been logged out</li>
</ul>
</li>
<li>
<strong>logcontent</strong>
<ul>
<li>username of the user that had logged out</li>
</ul>
</li>
</ul>
<p>This message type is binded with default <em>modalDialog</em>:</p>
<ul>
<li>logout_notLogIn (<code>data$success == FALSE</code>)</li>
<li>logout_success (<code>data$success == TRUE</code>)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="mail-message">Mail message<a class="anchor" aria-label="anchor" href="#mail-message"></a>
</h2>
<p><code>mail_message</code> field contains last <em>RegLogConnectorMessage</em> received from <em>mailConnector</em>. It only provides information about last process of sending email, which don’t signalize the change of the data or state of current login session, so it is separated from much more important <code>message</code> field.</p>
<div class="section level3">
<h3 id="type-reglog_mail">Type: <strong>reglog_mail</strong><a class="anchor" aria-label="anchor" href="#type-reglog_mail"></a>
</h3>
<p>This type of message is received after default e-mail sending from all RegLog processess. It contains:</p>
<ul>
<li>
<strong>data</strong>
<ul>
<li>process: character - name of the process for which e-mail was sent. Either ‘register’, ‘credsEdit’ or ‘resetPass’</li>
<li>success: boolean - <code>TRUE</code> if the email was sent sucessfully</li>
</ul>
</li>
<li>
<strong>logcontent</strong>
<ul>
<li>username and address to which email was sent, and the name of the process that triggered it. If <code>success == FALSE</code> it will also contain error message.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="type-custom_mail">Type: <strong>custom_mail</strong><a class="anchor" aria-label="anchor" href="#type-custom_mail"></a>
</h3>
<p>This type of message isn’t received during regular <em>RegLog</em> run. It is a response to message that you can use to send a custom e-mail. It contains the same responses as <strong>reglog_mail</strong> message.</p>
<p>To send a custom email using <em>mailConnector</em>, pass to its <em>listener</em> a <em>RegLogConnectorMessage</em> of type <em>custom_mail</em>, as in example below:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can observe some kind of event to trigger the send</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">send_custom_email</span>, <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># as the username and email will be acquired from RegLogServer,</span></span>
<span>  <span class="co"># it is best to make sure that the user is logged-in</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="va">RegLogServer</span><span class="op">$</span><span class="fu">is_logged</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">message_to_send</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RegLogConnectorMessage.html">RegLogConnectorMessage</a></span><span class="op">(</span></span>
<span>    type <span class="op">=</span> <span class="st">"custom_mail"</span>,</span>
<span>    <span class="co"># name your process in some unique way - it will be tracked by the app </span></span>
<span>    <span class="co"># and saved into logs</span></span>
<span>    process <span class="op">=</span> <span class="st">"attachement_mail!"</span>,</span>
<span>    <span class="co"># username and email can be gotten from RegLogServer</span></span>
<span>    username <span class="op">=</span> <span class="va">RegLogServer</span><span class="op">$</span><span class="fu">user_id</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    email <span class="op">=</span> <span class="va">RegLogServer</span><span class="op">$</span><span class="fu">user_mail</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="co"># we can specify the subject and body of message ourselves</span></span>
<span>    mail_subject <span class="op">=</span> <span class="st">"Custom message with attachement"</span>,</span>
<span>    <span class="co"># it's best for the body to contain html code</span></span>
<span>    mail_body <span class="op">=</span> <span class="st">"&lt;p&gt;This is a custom message send from my App&lt;/p&gt;</span></span>
<span><span class="st">                 &lt;p&gt;It is completely optional, but that kind of message can also</span></span>
<span><span class="st">                    contain an attachment!&lt;/p&gt;"</span>,</span>
<span>    <span class="co"># optionally: attachment</span></span>
<span>    mail_attachement <span class="op">=</span> <span class="st">"files/myplot.png"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="collected-logs-during-the-app-session">Collected logs during the App session<a class="anchor" aria-label="anchor" href="#collected-logs-during-the-app-session"></a>
</h2>
<p>During the lifespan of the session, <em>RegLogServer</em> object sends, shows and receives many different <em>RegLogConnectorMessages</em>. By default, all messages <strong>send</strong> to its <em>dbConnector</em> and <em>mailConnector</em> and <strong>received</strong> back are saved into the <code>RegLogServer$logs</code> field, into separate lists per direction. There are also some messages that are only <strong>shown</strong> by the object (namely all messages with "_front" suffix and message of type <strong>logout</strong>)</p>
<p>They contain following information:</p>
<ul>
<li>
<strong>time</strong> when the message was generated</li>
<li>
<strong>session</strong> in which the message was generated (taken from <code>session$token</code>)</li>
<li>
<strong>type</strong> of the message</li>
<li>
<strong>note</strong> in which the <code>logcontent</code> of the message is saved</li>
</ul>
<div class="section level3">
<h3 id="collecting-all-logs">Collecting all logs<a class="anchor" aria-label="anchor" href="#collecting-all-logs"></a>
</h3>
<p>You can use public method to get whole content of the logs collected up to this point in time in the form of <em>data.frame</em>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logs_df</span> <span class="op">&lt;-</span> <span class="va">RegLogServer</span><span class="op">$</span><span class="fu">get_logs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="configuring-reglogserver">Configuring RegLogServer<a class="anchor" aria-label="anchor" href="#configuring-reglogserver"></a>
</h2>
<p>As the whole <em>RegLog</em> system is created with elasticity in mind, there are also many options for customizing the behaviour of <em>RegLogServer</em> object.</p>
<div class="section level3">
<h3 id="customizing-messages-and-texts">Customizing messages and texts<a class="anchor" aria-label="anchor" href="#customizing-messages-and-texts"></a>
</h3>
<p>During <em>RegLogServer</em> object initialization you can specify some arguments:</p>
<ul>
<li><p><code>app_name</code> - name of your application that will show up in default emails sent to your users. Defaults to the name of root folder of your application.</p></li>
<li><p><code>app_address</code> - URL to your application that will show up in default emails sent to your users. Defaults to the URL that the App is accessed on the client side (actually: <code>NULL</code>, as the address is got on session start)</p></li>
<li><p><code>lang</code> - language in which the default texts are presented. Defaults to “en” for English. You can also specify “i18” for the RegLog to show only the content identifiers for ease of building your own translations using external tools, eg. <a href="https://github.com/Appsilon/shiny.i18n" class="external-link">shiny.i18n</a>.</p></li>
<li>
<p><code>custom_txts</code> - defaults to NULL. Can be a named list of character vectors that should be used in place of defined text for language of your choosing (to check them out, use <code>RegLog_texts()</code> function).</p>
<p>You can define custom texts during initialization of <em>RegLogServer</em>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="co"># initialize new RegLogServer object</span></span>
<span><span class="va">RegLog</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RegLogServer.html">RegLogServer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="co"># assign created dbConnector and mailConnector</span></span>
<span>  dbConnector <span class="op">=</span> <span class="va">dbConnector</span>,</span>
<span>  mailConnector <span class="op">=</span> <span class="va">mailConnector</span>,</span>
<span>  <span class="co"># replace default title and body of `login_success` modalDialog</span></span>
<span>  custom_txts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    login_success_t <span class="op">=</span> <span class="st">"Welcome!"</span>,</span>
<span>    login_success_b <span class="op">=</span> <span class="st">"Hi! It's nice to see you logged into our ShinyApp!"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><code>use_modals</code> - defaults to TRUE. If specified as <code>FALSE</code>, no default modals will be shown. You can also inhibit only specific modal dialogs by providing named list of FALSE values. Eg:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initialize new RegLogServer object</span></span>
<span><span class="va">RegLog</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RegLogServer.html">RegLogServer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="co"># assign created dbConnector and mailConnector</span></span>
<span>  dbConnector <span class="op">=</span> <span class="va">dbConnector</span>,</span>
<span>  mailConnector <span class="op">=</span> <span class="va">mailConnector</span>,</span>
<span>  <span class="co"># inhibit default 'login_success' and 'register_success' modals</span></span>
<span>  use_modals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    login_success <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    register_success <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="options-related-to-log-saving">Options related to log saving<a class="anchor" aria-label="anchor" href="#options-related-to-log-saving"></a>
</h3>
<p>There are two options that can be defined in the script that relates to the log collection: <em>RegLogServer.logs</em> that defines saving logs to <code>RegLogServer$logs</code> and <em>RegLogServer.logs_to_database</em> that defines saving the logs into table or spreadsheet created for log-recording purposes.</p>
<blockquote>
<p>To save logs into database, remember to firstly create a table or spreadsheet. During tables creation with either <code>DBI_tables_create</code> or <code>gsheet_tables_create</code> specify argument <code>use_log = T</code>.</p>
</blockquote>
<p>To define options just insert in the beginning of your script:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># examples with default values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"RegLogServer.logs"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"RegLogServer.logs_to_database"</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Possible values:</p>
<ul>
<li>0: no message is saved into logs/database</li>
<li>1: messages <strong>sent</strong> and <strong>received</strong> are saved</li>
<li>2: all messages are saved</li>
</ul>
<blockquote>
<p>It isn’t recommended to save any logs into database when using <em>RegLogGsheetConnector</em> as your database driver. All actions made on the <em>googlesheets</em> database are taking significant time. Recommended only during testing/debugging runs.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="options-related-to-e-mail-sending">Options related to e-mail sending<a class="anchor" aria-label="anchor" href="#options-related-to-e-mail-sending"></a>
</h3>
<p>By default, <em>RegLogServer</em> will trigger an e-mail send to users of your ShinyApp after they are registered, when they attempt reset password procedure (to provide them with their reset code) and after changing their user ID or e-mail during the credentials edit procedure.</p>
<p>As the e-mail sending is mandatory during reset password procedure, there is no option to inhibit it, but the other messages are only recommended as they are enriching the user experience. If you are concerned with the amount of e-mails that can be sent from your app, you can inhibit these messages using following options:</p>
<ul>
<li><code>options("RegLogServer.register_mail" = FALSE)</code></li>
<li><code>options("RegLogServer.credsEdit_mail" = FALSE)</code></li>
</ul>
<p>To inhibit all e-mail sending (eg. if the app is under development, you are debugging it or only playing with the package currently), you can pass an <code>RegLogConnector</code> object to the <code>mailConnector</code> argument during initialization of the <em>RegLogServer</em>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RegLog</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/RegLogServer.html">RegLogServer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  dbConnector <span class="op">=</span> <span class="va">somedbConnector</span>,</span>
<span>  mailConnector <span class="op">=</span> <span class="va"><a href="../reference/RegLogConnector.html">RegLogConnector</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michal Kosinski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
